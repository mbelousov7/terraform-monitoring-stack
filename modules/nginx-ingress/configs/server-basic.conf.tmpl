%{ for server in server_list ~}
server {
 listen ${ container_port };
 #resolver ${ resolver } valid=10s;
 server_name ^${ server.app_name }*;
 location / {
   auth_basic "Restricted";
   auth_basic_user_file /etc/nginx/password/.htpasswd;
   set $upstream http://${ server.app_name }.${ namespace }.svc.cluster.local:9090;
   proxy_pass $upstream;
 }
}
%{ endfor ~}
